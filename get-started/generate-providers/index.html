<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Generate google and google-beta providers # This quickstart guides you through setting up your development environment, making a change to magic-modules, generating provider changes to the google and google-beta Terraform providers, and running tests related to the change.
Before you begin # Install the gcloud CLI. In the Google Cloud console, on the project selector page, select or create a Google Cloud project. Note: If you don&rsquo;t already have a project to use for testing changes to the Terraform providers, create a project instead of selecting an existing poject."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Generate the providers"><meta property="og:description" content="Generate google and google-beta providers # This quickstart guides you through setting up your development environment, making a change to magic-modules, generating provider changes to the google and google-beta Terraform providers, and running tests related to the change.
Before you begin # Install the gcloud CLI. In the Google Cloud console, on the project selector page, select or create a Google Cloud project. Note: If you don&rsquo;t already have a project to use for testing changes to the Terraform providers, create a project instead of selecting an existing poject."><meta property="og:type" content="article"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/get-started/generate-providers/"><meta property="article:section" content="get-started"><meta property="article:modified_time" content="2023-09-07T14:55:52-07:00"><title>Generate the providers | Magic Modules</title><link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png type=image/x-icon><link rel=stylesheet href=/magic-modules/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/magic-modules/flexsearch.min.js></script>
<script defer src=/magic-modules/en.search.min.f921d479585e130a026fbb164211138bf12c4d03d41f7d1a6d1606f5826b7872.js integrity="sha256-+SHUeVheEwoCb7sWQhETi/EsTQPUH30abRYG9YJreHI=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><span>Get started</span><ul><li><a href=/magic-modules/get-started/generate-providers/ class=active>Generate the providers</a></li><li><a href=/magic-modules/get-started/how-magic-modules-works/>How Magic Modules works</a></li><li><a href=/magic-modules/get-started/contribution-process/>Contribution process</a></li></ul></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/resource/>Add or modify a resource</a></li><li><a href=/magic-modules/develop/field-reference/>MMv1 field reference</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/permadiff/>Fix a permadiff</a></li><li><input type=checkbox id=section-9ccce47fb686ac21da7c5aafec70c7aa class=toggle>
<label for=section-9ccce47fb686ac21da7c5aafec70c7aa class="flex justify-between"><a role=button>Test</a></label><ul><li><a href=/magic-modules/develop/test/test/>Add resource tests</a></li><li><a href=/magic-modules/develop/test/run-tests/>Run tests</a></li></ul></li><li><input type=checkbox id=section-74c6da531f3d2c4b4f43bdae497559e2 class=toggle>
<label for=section-74c6da531f3d2c4b4f43bdae497559e2 class="flex justify-between"><a role=button>Breaking changes</a></label><ul><li><a href=/magic-modules/develop/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/develop/breaking-changes/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><a href=/magic-modules/develop/handwritten-docs-style-guide/>Handwritten docs style guide</a></li></ul></li><li><a href=/magic-modules/best-practices/>Best practices</a><ul></ul></li><li><span>Contribute</span><ul><li><a href=/magic-modules/contribute/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/contribute/release-notes/>Write release notes</a></li><li><a href=/magic-modules/contribute/review-pr/>Review a pull request</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource.rb target=_blank rel=noopener>Resource YAML reference ↗</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource/iam_policy.rb target=_blank rel=noopener>IAM policy YAML reference ↗</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Generate the providers</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before you begin</a></li><li><a href=#set-up-your-development-environment>Set up your development environment</a></li><li><a href=#generate-a-provider-change>Generate a provider change</a></li><li><a href=#test-changes>Test changes</a></li><li><a href=#troubleshoot>Troubleshoot</a><ul><li><a href=#too-many-open-files>Too many open files</a></li></ul></li><li><a href=#cleanup>Cleanup</a></li><li><a href=#whats-next>What&rsquo;s next</a></li></ul></nav></aside></header><article class=markdown><h1 id=generate-google-and-google-beta-providers>Generate <code>google</code> and <code>google-beta</code> providers
<a class=anchor href=#generate-google-and-google-beta-providers>#</a></h1><p>This quickstart guides you through setting up your development environment, making a change to <code>magic-modules</code>, generating provider changes to the <code>google</code> and <code>google-beta</code> Terraform providers, and running tests related to the change.</p><h2 id=before-you-begin>Before you begin
<a class=anchor href=#before-you-begin>#</a></h2><ol><li><a href=https://cloud.google.com/sdk/docs/install>Install the gcloud CLI.</a></li><li>In the Google Cloud console, on the project selector page, select or <a href=https://cloud.google.com/resource-manager/docs/creating-managing-projects>create a Google Cloud project</a>.<blockquote class="book-hint info"><strong>Note:</strong> If you don&rsquo;t already have a project to use for testing changes to the Terraform providers, create a project instead of selecting an existing poject. After you finish these steps, you can delete the project, removing all resources associated with the project.</blockquote><a href=https://console.cloud.google.com/projectselector2/home/dashboard target=_blank rel=noopener class=book-btn>Go to project selector</a></li><li>Make sure that billing is enabled for your Google Cloud project. Learn how to <a href=https://cloud.google.com/billing/docs/how-to/verify-billing-enabled>check if billing is enabled on a project</a>.</li></ol><h2 id=set-up-your-development-environment>Set up your development environment
<a class=anchor href=#set-up-your-development-environment>#</a></h2><blockquote class="book-hint warning">If you are familiar with Docker or Podman, you may want to use the experimental <a href=https://googlecloudplatform.github.io/magic-modules/reference/make-commands/#container-based-environment>container-based environment</a> instead of this section.</blockquote><ol><li><p><a href=https://git-scm.com/book/en/v2/Getting-Started-Installing-Git>Install git</a></p></li><li><p><a href=https://github.com/rbenv/rbenv#installation>Install rbenv</a>, ensuring you follow <strong>both</strong> steps 1 and 2.</p></li><li><p>Use rbenv to install ruby 3.1.0</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rbenv install 3.1.0
</span></span></code></pre></div></li><li><p><a href=https://go.dev/doc/install>Install go</a></p></li><li><p>Install goimports</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go install golang.org/x/tools/cmd/goimports@latest
</span></span></code></pre></div></li><li><p><a href=https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli>Install terraform</a></p></li><li><p>Clone the <code>magic-modules</code> repository</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd ~
</span></span><span style=display:flex><span>git clone https://github.com/GoogleCloudPlatform/magic-modules.git
</span></span></code></pre></div></li><li><p>Run the following command from the root of your cloned <code>magic-modules</code> repository.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd magic-modules
</span></span><span style=display:flex><span>./scripts/doctor
</span></span></code></pre></div><p>Expected output if everything is installed properly:</p><pre tabindex=0><code>Check for ruby in path...
   found!
Check for go in path...
   found!
Check for goimports in path...
   found!
Check for git in path...
   found!
Check for terraform in path...
   found!
Check for make in path...
   found!
</code></pre></li></ol><h2 id=generate-a-provider-change>Generate a provider change
<a class=anchor href=#generate-a-provider-change>#</a></h2><ol><li><p>In your cloned magic-modules repository, edit <code>mmv1/products/pubsub/Topic.yaml</code> to change the description for the schemaSettings field:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- !<span style=color:#ae81ff>ruby/object:Api::Type::NestedObject</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;schemaSettings&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>description</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    UPDATED_DESCRIPTION</span>    
</span></span></code></pre></div></li><li><p>Clone the <code>google</code> and <code>google-beta</code> provider repositories with the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/hashicorp/terraform-provider-google.git $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>git clone https://github.com/hashicorp/terraform-provider-google-beta.git $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span></code></pre></div></li><li><p>Generate changes for the <code>google</code> provider</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>ga OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google&#34;</span> PRODUCT<span style=color:#f92672>=</span>pubsub
</span></span></code></pre></div></li><li><p>Generate changes for the <code>google-beta</code> provider</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>beta OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google-beta&#34;</span> PRODUCT<span style=color:#f92672>=</span>pubsub
</span></span></code></pre></div></li><li><p>Confirm that the expected changes were generated</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>git diff -U0
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>git diff -U0
</span></span></code></pre></div><p>In both cases, the changes should include:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span>diff --git a/google-beta/resource_pubsub_topic.go b/google-beta/resource_pubsub_topic.go
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/google-beta/resource_pubsub_topic.go
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/google-beta/resource_pubsub_topic.go
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -115 +115 @@ and is not a valid configuration.`,
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>-                               Description: `Settings for validating messages published against a schema.`,
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+                               Description: `UPDATED_DESCRIPTION`,
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>diff --git a/website/docs/r/pubsub_topic.html.markdown b/website/docs/r/pubsub_topic.html.markdown
</span></span><span style=display:flex><span><span style=color:#f92672>--- a/website/docs/r/pubsub_topic.html.markdown
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/website/docs/r/pubsub_topic.html.markdown
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -146 +146 @@ The following arguments are supported:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>-  Settings for validating messages published against a schema.
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+  UPDATED_DESCRIPTION
</span></span></span></code></pre></div><blockquote class="book-hint info"><strong>Note</strong>: There may be additional changes present due to specifying a <code>PRODUCT=</code> value or due to the <code>magic-modules</code> repository being out of sync with the provider repositories. This is okay as long as tests in the following section pass.</blockquote></li></ol><h2 id=test-changes>Test changes
<a class=anchor href=#test-changes>#</a></h2><ol><li><p>Set up application default credentials for Terraform</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud auth application-default login
</span></span><span style=display:flex><span>export GOOGLE_USE_DEFAULT_CREDENTIALS<span style=color:#f92672>=</span>true
</span></span></code></pre></div></li><li><p>Set required environment variables</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export GOOGLE_PROJECT<span style=color:#f92672>=</span>PROJECT_ID
</span></span><span style=display:flex><span>export GOOGLE_REGION<span style=color:#f92672>=</span>us-central1
</span></span><span style=display:flex><span>export GOOGLE_ZONE<span style=color:#f92672>=</span>us-central1-a
</span></span></code></pre></div><p>Replace <code>PROJECT_ID</code> with the ID of your Google Cloud project.</p></li><li><p>Enable required APIs</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud config set project $GOOGLE_PROJECT
</span></span><span style=display:flex><span>gcloud services enable pubsub.googleapis.com
</span></span><span style=display:flex><span>gcloud services enable cloudkms.googleapis.com
</span></span></code></pre></div></li><li><p>Run all linters</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make lint
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make lint
</span></span></code></pre></div></li><li><p>Run all unit tests</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make test
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make test
</span></span></code></pre></div></li><li><p>Run acceptance tests for Pub/Sub Topic</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google/services/pubsub TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccPubsubTopic_&#39;</span>
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google-beta/services/pubsub TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccPubsubTopic_&#39;</span>
</span></span></code></pre></div></li></ol><h2 id=troubleshoot>Troubleshoot
<a class=anchor href=#troubleshoot>#</a></h2><h3 id=too-many-open-files>Too many open files
<a class=anchor href=#too-many-open-files>#</a></h3><p>If you are getting “Too many open files” ulimit needs to be raised.</p><div class=book-tabs><input type=radio class=toggle name=tabs-ulimit id=tabs-ulimit-0 checked>
<label for=tabs-ulimit-0>Mac OS</label><div class="book-tabs-content markdown-inner"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ulimit -n <span style=color:#ae81ff>8192</span>
</span></span></code></pre></div></div></div><h2 id=cleanup>Cleanup
<a class=anchor href=#cleanup>#</a></h2><ol><li>Optional: Revoke credentials from the gcloud CLI.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud auth revoke
</span></span></code></pre></div><h2 id=whats-next>What&rsquo;s next
<a class=anchor href=#whats-next>#</a></h2><ul><li><a href=https://googlecloudplatform.github.io/magic-modules/get-started/how-magic-modules-works/>Learn about Magic Modules</a></li><li><a href=https://googlecloudplatform.github.io/magic-modules/get-started/contribution-process/>Learn about the contribution process</a></li><li><a href=https://googlecloudplatform.github.io/magic-modules/reference/make-commands/>Learn about make commands</a></li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/3e4723e8469258ac7382c94f2983cfb4723bb2a2 title='Last modified by Ayberk Yılmaz | September 7, 2023' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>September 7, 2023</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/get-started%2fgenerate-providers.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/get-started/generate-providers.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before you begin</a></li><li><a href=#set-up-your-development-environment>Set up your development environment</a></li><li><a href=#generate-a-provider-change>Generate a provider change</a></li><li><a href=#test-changes>Test changes</a></li><li><a href=#troubleshoot>Troubleshoot</a><ul><li><a href=#too-many-open-files>Too many open files</a></li></ul></li><li><a href=#cleanup>Cleanup</a></li><li><a href=#whats-next>What&rsquo;s next</a></li></ul></nav></div></aside></main></body></html>