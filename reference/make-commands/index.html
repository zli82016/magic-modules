<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="make commands reference # magic-modules # make / make provider # Generates the code for the downstream google and google-beta providers.
Note: Generation works best if the downstream provider has a commit checked out corresponding to the latest main branch commit that is present in your magic-modules working branch. This can generally be identified based on matching commit messages. Examples:
make provider VERSION=ga OUTPUT_PATH=&#34;$GOPATH/src/github.com/hashicorp/terraform-provider-google&#34; make provider VERSION=beta OUTPUT_PATH=&#34;$GOPATH/src/github.com/hashicorp/terraform-provider-google-beta&#34; # Only generate a specific product (plus all common files) make provider VERSION=ga OUTPUT_PATH=&#34;$GOPATH/src/github."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="make commands"><meta property="og:description" content="make commands reference # magic-modules # make / make provider # Generates the code for the downstream google and google-beta providers.
Note: Generation works best if the downstream provider has a commit checked out corresponding to the latest main branch commit that is present in your magic-modules working branch. This can generally be identified based on matching commit messages. Examples:
make provider VERSION=ga OUTPUT_PATH=&#34;$GOPATH/src/github.com/hashicorp/terraform-provider-google&#34; make provider VERSION=beta OUTPUT_PATH=&#34;$GOPATH/src/github.com/hashicorp/terraform-provider-google-beta&#34; # Only generate a specific product (plus all common files) make provider VERSION=ga OUTPUT_PATH=&#34;$GOPATH/src/github."><meta property="og:type" content="article"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/reference/make-commands/"><meta property="article:section" content="reference"><meta property="article:modified_time" content="2023-06-28T13:57:17-07:00"><title>make commands | Magic Modules</title><link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png type=image/x-icon><link rel=stylesheet href=/magic-modules/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/magic-modules/flexsearch.min.js></script>
<script defer src=/magic-modules/en.search.min.0f5abebea7e0cb821afa4dd8a42c30ed905606d53566265ff978a772a5633c95.js integrity="sha256-D1q+vqfgy4Ia+k3YpCww7ZBWBtU1ZiZf+XincqVjPJU=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><span>Get started</span><ul><li><a href=/magic-modules/get-started/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/get-started/how-magic-modules-works/>How Magic Modules works</a></li><li><a href=/magic-modules/get-started/contribution-process/>Contribution process</a></li></ul></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/resource/>Add or modify a resource</a></li><li><a href=/magic-modules/develop/field-reference/>MMv1 field reference</a></li><li><a href=/magic-modules/develop/custom-code/>Add custom resource code</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/permadiff/>Fix a permadiff</a></li><li><input type=checkbox id=section-9ccce47fb686ac21da7c5aafec70c7aa class=toggle>
<label for=section-9ccce47fb686ac21da7c5aafec70c7aa class="flex justify-between"><a role=button>Test</a></label><ul><li><a href=/magic-modules/develop/test/test/>Add resource tests</a></li><li><a href=/magic-modules/develop/test/run-tests/>Run tests</a></li></ul></li><li><input type=checkbox id=section-74c6da531f3d2c4b4f43bdae497559e2 class=toggle>
<label for=section-74c6da531f3d2c4b4f43bdae497559e2 class="flex justify-between"><a role=button>Breaking changes</a></label><ul><li><a href=/magic-modules/develop/breaking-changes/breaking-changes/>Types of breaking changes</a></li><li><a href=/magic-modules/develop/breaking-changes/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><a href=/magic-modules/develop/handwritten-docs-style-guide/>Handwritten docs style guide</a></li></ul></li><li><a href=/magic-modules/best-practices/>Best practices</a><ul></ul></li><li><span>Contribute</span><ul><li><a href=/magic-modules/contribute/create-pr/>Create a pull request</a></li><li><a href=/magic-modules/contribute/release-notes/>Write release notes</a></li><li><a href=/magic-modules/contribute/review-pr/>Review a pull request</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/make-commands/ class=active>make commands</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource.rb target=_blank rel=noopener>Resource YAML reference ↗</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource/iam_policy.rb target=_blank rel=noopener>IAM policy YAML reference ↗</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu></label>
<strong>make commands</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#magic-modules><code>magic-modules</code></a><ul><li><a href=#make--make-provider><code>make</code> / <code>make provider</code></a></li><li><a href=#container-based-environment>Container-based environment</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=make-commands-reference><code>make</code> commands reference
<a class=anchor href=#make-commands-reference>#</a></h1><h2 id=magic-modules><code>magic-modules</code>
<a class=anchor href=#magic-modules>#</a></h2><h3 id=make--make-provider><code>make</code> / <code>make provider</code>
<a class=anchor href=#make--make-provider>#</a></h3><p>Generates the code for the downstream <code>google</code> and <code>google-beta</code> providers.</p><blockquote class="book-hint info"><strong>Note:</strong> Generation works best if the downstream provider has a commit checked out corresponding to the latest <code>main</code> branch commit that is present in your <code>magic-modules</code> working branch. This can generally be identified based on matching commit messages.</blockquote><p>Examples:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>ga OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google&#34;</span>
</span></span><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>beta OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google-beta&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Only generate a specific product (plus all common files)</span>
</span></span><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>ga OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google&#34;</span> PRODUCT<span style=color:#f92672>=</span>pubsub
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Only generate only a specific resources for a product</span>
</span></span><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>ga OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google&#34;</span> PRODUCT<span style=color:#f92672>=</span>pubsub RESOURCE<span style=color:#f92672>=</span>Topic
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Only generate common files, including all third_party code</span>
</span></span><span style=display:flex><span>make provider VERSION<span style=color:#f92672>=</span>ga OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google&#34;</span> PRODUCT<span style=color:#f92672>=</span>doesnotexist
</span></span></code></pre></div><h4 id=arguments>Arguments
<a class=anchor href=#arguments>#</a></h4><ul><li><code>OUTPUT_PATH</code>: Required. The location you are generating provider code into.</li><li><code>VERSION</code>: Required. The version of the provider you are building into. Valid values are <code>ga</code> and <code>beta</code>.</li><li><code>PRODUCT</code>: Limits generations to the specified folder within <code>mmv1/products</code> or <code>tpgtools/api</code>. Handwritten files from <code>mmv1/third_party/terraform</code> are always generated into the downstream regardless of this setting, so you can provide a non-existant product name to generate only handwritten code. Required if <code>RESOURCE</code> is specified.</li><li><code>RESOURCE</code>: Limits generation to the specified resource within a particular product. For <code>mmv1</code> resources, matches the resource&rsquo;s <code>name</code> field (set in its configuration file).For <code>tpgtools</code> resources, matches the terraform resource name.</li><li><code>ENGINE</code>: Modifies <code>make provider</code> to only generate code using the specified engine. Valid values are <code>mmv1</code> or <code>tpgtools</code>. (Providing <code>tpgtools</code> will still generate any prerequisite mmv1 files required for tpgtools.)</li></ul><h4 id=cleaning-up-old-files>Cleaning up old files
<a class=anchor href=#cleaning-up-old-files>#</a></h4><p>Magic Modules will only generate on top of whatever is in the downstream repository. This means that, from time
to time, you may end up with stale files or changes in your downstream that cause compilation or tests to fail.</p><p>You can clean up by running the following command in your downstream repositories:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git checkout -- . <span style=color:#f92672>&amp;&amp;</span> git clean -f google/ google-beta/ website/
</span></span></code></pre></div><h3 id=container-based-environment>Container-based environment
<a class=anchor href=#container-based-environment>#</a></h3><blockquote class="book-hint warning">This approach is in beta and still collecting feedback. Please <a href=https://github.com/hashicorp/terraform-provider-google/issues/new/choose>file an issue</a> if you encounter challenges.</blockquote><p><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/scripts/make-in-container.sh><code>./scripts/make-in-container.sh</code></a> runs <code>make</code> with the provided arguments inside a container with all necessary dependencies preinstalled. It uses <a href=https://docker.io/>Docker</a> if available and <a href=https://podman.io/>Podman</a> otherwise. Like <code>make</code>, this script must be run in the root of a <code>magic-modules</code> repository clone.</p><p>If you run into any problems, please <a href=https://github.com/hashicorp/terraform-provider-google/issues/new/choose>file an issue</a>.</p><h4 id=before-you-begin>Before you begin
<a class=anchor href=#before-you-begin>#</a></h4><ol><li><p>Ensure that <code>GOPATH</code> is set on your host machine.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>printenv | grep GOPATH
</span></span></code></pre></div><p>If not, add <code>export GOPATH=$HOME/go</code> to your terminal&rsquo;s startup script and restart your terminal.</p></li><li><p>Clone the <code>google</code> and <code>google-beta</code> provider repositories with the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/hashicorp/terraform-provider-google.git $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>git clone https://github.com/hashicorp/terraform-provider-google-beta.git $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span></code></pre></div></li></ol><h4 id=example>Example
<a class=anchor href=#example>#</a></h4><p>To build the <code>google</code> provider, run the following command in the root of a <code>magic-modules</code> repository clone:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./scripts/make-in-container.sh <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  terraform VERSION<span style=color:#f92672>=</span>ga <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  OUTPUT_PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$GOPATH<span style=color:#e6db74>/src/github.com/hashicorp/terraform-provider-google&#34;</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/24977f31287257347604262b304c8b2d8e01692e title='Last modified by Stephen Lewis (Burrows) | June 28, 2023' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 28, 2023</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/reference%2fmake-commands.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/reference/make-commands.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#magic-modules><code>magic-modules</code></a><ul><li><a href=#make--make-provider><code>make</code> / <code>make provider</code></a></li><li><a href=#container-based-environment>Container-based environment</a></li></ul></li></ul></nav></div></aside></main></body></html>